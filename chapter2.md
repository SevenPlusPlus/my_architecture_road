---
## 打造构建统一微服务技术栈和基础设施

### KkRpc作为微服务框架核心

KKRPC服务治理框架作为KK后台微服务框架的核心，是在阿里巴巴的开源核心服务治理框架Dubbo基础上根据KK的后端业务应用场景裁减、定制、扩展而来，在吸收Dubbo优秀架构设计经验的基础上与其他微服务基础设施和技术栈工具集深度集成融合，从而更简洁、实用和高效。KKRPC主要解决服务拆分后透明的、高性能的跨服务调用问题，但也远不止于如此，比如服务的监控治理，生产问题的快速定位、干预，以及对周边框架设施的扩展支持等等，而且在不同的环境、规模和业务形态下，也会有特定的需求和挑战，这也正是我们以及很多公司都选择构建自己的RPC框架的核心原因。

### 微服务服务治理

微服务化的进程中，服务治理能力对后端系统的稳定性至关重要，KKRPC提供了超时返回、请求堆积容量控制、接口及方法限流、接口及方法降级、消费端熔断策略、信号量隔离、线程隔离等多种服务治理手段，并且支持运行时动态调整服务治理策略。为了方便运维人员生产线上快速干预，研发了KKRPC服务治理后台管理系统。

### 业务监控、全链路调用链跟踪

微服务成倍增长、服务间调用越来越复杂、请求调用链路越来越长，研发运维人员在线上故障定位、性能分析优化时面对着更大的挑战。因此我们引入了点评优秀的开源业务监控系统CAT，对从API访问到模块调用到CACHE、DB查询的整个业务处理过程进行全链路日志埋点跟踪，这样极大的提高了运维开发人员线上故障排查和定位的效率。

### 统一配置中心，标准打包、部署持续集成

成倍增长的微服务的快速迭代也给运维人员的打包、部署、发布上线效率提出了更高的要求。我们在微服务模块项目研发中采用统一的项目骨架、标准的打包插件和启动脚本，并且引入百度开源的Disconf统一配置中心，将有状态的、易变的配置文件根据不同版本和不同环境置于配置中心统一管理，这样使得整个打包、部署发布过程标准化、无状态化、脚本化。运维人员在此基础上利用jenkins持续集成系统以及自研的构建发布脚本，极大的提高了微服务发布上线的效率，而且降低了出错率。

### 直播平台后台微服务实践总结

后台微服务实践如下图：

![](/assets/直播平台后台微服务实践.png)

后端开发框架包依赖汇总图如下：

![](/assets/后端开发框架包依赖汇总.png)


